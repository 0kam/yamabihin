# レコーダー管理アプリ - 交換・メンテナンス記録画面

## 画面概要
レコーダーの交換やメンテナンス作業を統合的に記録するための画面です。バッテリー交換、SDカード交換、録音スケジュール変更、その他のメンテナンスをワンストップで記録できます。

## 画面レイアウト

```
+------------------------------------------+
| ヘッダー [戻る] [ユーザー名] [ログアウト]|
+------------------------------------------+
| レコーダー管理 > 交換・メンテナンス記録  |
+------------------------------------------+
|                                          |
| 【レコーダー情報】                       |
| ID: REC00008                            |
| 設置場所: 知床・羅臼                     |
|                                          |
| 実施日*                                  |
| [カレンダーから選択]                     |
|                                          |
| 実施者*                                  |
| [                                ]       |
|                                          |
| 【作業内容】                             |
| バッテリー交換: [✓] はい [ ] いいえ      |
| SDカード交換: [✓] はい [ ] いいえ        |
| 録音スケジュール変更: [ ] はい [✓] いいえ |
| その他のメンテナンス: [✓] はい [ ] いいえ |
|                                          |
| 【バッテリー交換情報】                   |
| 新しいバッテリータイプ                   |
| [単3アルカリ ▼]                         |
|                                          |
| 新しいバッテリー電圧                     |
| [1.5] V                                 |
|                                          |
| 新しいバッテリー容量                     |
| [2500] mAh                              |
|                                          |
| 【SDカード交換情報】                     |
| 新しいストレージ容量                     |
| [32] GB                                 |
|                                          |
| 【録音スケジュール変更情報】             |
| 開始時間: [04 ▼] : [00 ▼]              |
| 終了時間: [20 ▼] : [00 ▼]              |
| 録音間隔: オン[10]分 オフ[20]分          |
| サンプリングレート: [44100] Hz           |
| チャンネル数: [ステレオ ▼]               |
|                                          |
| 1日あたりの電力消費                      |
| [210] mWh                               |
|                                          |
| 1日あたりのストレージ消費                |
| [250] MB                                |
|                                          |
| 【その他のメンテナンス詳細】             |
| メンテナンス種類:                        |
| [ ] 故障修理 [✓] 清掃 [ ] 点検          |
| [ ] ファームウェア更新 [ ] その他        |
|                                          |
| 詳細説明:                                |
| [マイク部分の清掃を実施しました。...]    |
|                                          |
| +----------------------------------+     |
| |          キャンセル              |     |
| +----------------------------------+     |
|                                          |
| +----------------------------------+     |
| |            完了                 |     |
| +----------------------------------+     |
|                                          |
+------------------------------------------+
| フッター                                 |
+------------------------------------------+
```

## 動的表示ロジック

1. 各セクション（バッテリー交換、SDカード交換、録音スケジュール変更、その他メンテナンス）は、対応するチェックボックスが選択された場合のみ表示します。

2. 初期表示時は全てのセクションが折りたたまれており、ユーザーが「はい」を選択したセクションのみ展開されます。

3. 録音スケジュール変更セクションでは、スケジュールを変更すると、1日あたりの電力消費とストレージ消費の入力欄も表示されます。

4. その他のメンテナンスセクションでは、複数のメンテナンス種類を選択できます。「その他」を選択した場合は追加の詳細入力欄を表示します。

## 入力検証ルール

1. **必須項目**：
   - 実施日
   - 実施者
   - 各セクションの主要入力項目（チェックされた場合のみ）

2. **数値検証**：
   - バッテリー電圧: 正の数値
   - バッテリー容量: 正の整数
   - ストレージ容量: 正の整数
   - 録音間隔: 正の整数
   - 電力消費: 正の数値
   - ストレージ消費: 正の数値

3. **日付検証**：
   - 実施日は過去または当日の日付のみ許可

## 保存時の処理

1. 入力されたデータをデータベースの`recorder_maintenances`テーブルに保存します。

2. バッテリー交換やSDカード交換が行われた場合は、`recorder_schedules`テーブルの最終交換日と次回交換予定日を更新します。

3. 録音スケジュールが変更された場合は、`recorders`テーブルの録音スケジュール情報と`recorder_schedules`テーブルの消費量情報を更新します。

4. 保存完了後、レコーダー詳細画面に戻り、更新された情報を表示します。

## 使用上の注意点

1. この画面は、ユーザーが現場でレコーダーのメンテナンスを行った際に、その情報をまとめて記録するためのものです。

2. 録音スケジュール変更を行った場合、それに応じて1日あたりの電力消費とストレージ消費も再計算または再入力する必要があります。

3. バッテリーやSDカードの交換情報は、次回交換予定日の自動計算に使用されます。

4. バッテリー交換やSDカード交換により、備品の移動が発生した場合は、自動的に備品管理アプリの移動履歴にも反映されます。